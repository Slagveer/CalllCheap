<?xml version="1.0" encoding="utf-8"?>
<s:View xmlns:fx="http://ns.adobe.com/mxml/2009" 
		xmlns:s="library://ns.adobe.com/flex/spark" title="CallCheap" xmlns:fxg="skins.fxg.*" creationComplete="creationCompleteHandler(event)" xmlns:dao="dao.*">
	<fx:Declarations>
		<!-- Place non-visual elements (e.g., services, value objects) here -->
		<dao:BedrijfDAO id="srv"/>
	</fx:Declarations>
	<fx:Script>
		<![CDATA[
			import mx.collections.ArrayCollection;
			import mx.events.FlexEvent;
			
			import spark.events.IndexChangeEvent;
			
			import skins.actionscript.ActionBarButton;
			[Bindable]
			private var startLength:Number = 0;
			[Bindable]
			private var searchLength:Number = 0;
			[Bindable]
			private var bedrijven:ArrayCollection = new ArrayCollection();
			
			protected function searchBar_clickHandler(event:MouseEvent):void
			{
				// TODO Auto-generated method stub
				this.bedrijven = srv.findByName(this.key.text);
				this.data.key = this.key.text;
				if(bedrijven){
					this.searchLength = bedrijven.length;
				}else{
					this.searchLength = 0;
				}
			}
			
			protected function creationCompleteHandler(event:FlexEvent):void
			{
				// TODO Auto-generated method stub
				this.searchBar.percentWidth = 100;
				if(this.data !== null){
					this.bedrijven = srv.findByName(this.data.key);
					this.key.text = this.data.key;
					this.startLength = this.data.startLength;
				}else{
					this.bedrijven = srv.findByName('');
					this.data = new Object();
					this.data.startLength = this.bedrijven.length;
					this.startLength = this.bedrijven.length;
				}
				
				if(this.bedrijven != null){
					//startLength = this.bedrijven.length;
					searchLength = this.bedrijven.length;
				}
			}
			
			protected function clickHandler(event:MouseEvent):void
			{
				// TODO Auto-generated method stub
				this.navigator.pushView(CallCheapInfoView);
			}
			
			protected function list_changeHandler(event:IndexChangeEvent):void
			{
				// TODO Auto-generated method stub
				
			}
			
			protected function list_clickHandler(event:MouseEvent):void
			{
				// TODO Auto-generated method stub
				trace(list.selectedItem["goedkoop"]);
			}
			
		]]>
	</fx:Script>
	
	<s:actionContent>
		<s:Button skinClass="skins.actionscript.ActionBarButton" icon="@Embed('assets/icons/info_icon.png')" click="navigator.pushView(CallCheapInfoView, this.data)"/>
		<s:Button skinClass="skins.actionscript.ActionBarButton" icon="@Embed('assets/icons/mobile_icon.png')"/>
		<s:Button skinClass="skins.actionscript.ActionBarButton" icon="@Embed('assets/icons/search_icon.png')" click="navigator.pushView(CallCheapSearchView, this.data)"/>
	</s:actionContent> 
	
	<s:Group>
		<s:Rect width="500" height="100">
			<s:fill><s:SolidColor color="0x1E2427" /></s:fill>
		</s:Rect>
		<s:Line xFrom="0" yFrom="88" xTo="500" yTo="88">
			<s:stroke>
				<s:SolidColorStroke color="0x141B1F"/>
			</s:stroke>
		</s:Line>
		<s:Line xFrom="0" yFrom="89" xTo="500" yTo="89">
			<s:stroke>
				<s:SolidColorStroke color="0x272E31"/>
			</s:stroke>
		</s:Line>
		
		<s:Group id="searchBar">
			<s:layout>
				<s:HorizontalLayout horizontalAlign="center" gap="0" verticalAlign="middle" paddingTop="15"/>
			</s:layout>
		
			<s:Button skinClass="skins.actionscript.SearchBarButton" width="55" height="53" click="searchBar_clickHandler(event)"/>
			
			<s:SkinnableContainer skinClass="skins.actionscript.SearchBarTextInput" width="374">
				<s:TextInput id="key" bottom="0" left="0" top="1" right="10" styleName="searchbar-text" borderVisible="false" height="52" contentBackgroundColor="0xFFFFFF">
					<s:text>Type bedrijfsnaam of nummer</s:text>
				</s:TextInput>
			</s:SkinnableContainer>	
		</s:Group>
	</s:Group>
	
	<s:List id="list" top="90" bottom="90" left="0" right="0" dataProvider="{bedrijven}" horizontalScrollPolicy="off" itemRenderer="renderers.BedrijfRenderer" contentBackgroundAlpha="0" change="list_changeHandler(event)" click="list_clickHandler(event)"/>
	
	<s:Group bottom="0">
		<s:Rect width="500" height="49" bottom="0">
			<s:fill><s:SolidColor color="0x1E2427" /></s:fill>
		</s:Rect>
		<s:Rect width="500" height="39" bottom="49">
			<s:fill><s:SolidColor color="0x22272A" /></s:fill>
		</s:Rect>

		<s:Group bottom="0" height="90">
			<s:layout>
				<s:VerticalLayout gap="0" paddingTop="0" paddingBottom="0"/>
			</s:layout>
			<s:Line xFrom="0" yFrom="90" xTo="500" yTo="90">
				<s:stroke>
					<s:SolidColorStroke color="0x141B1F" weight="1"/>
				</s:stroke>
			</s:Line>
			<s:Line xFrom="0" yFrom="89" xTo="500" yTo="89">
				<s:stroke>
					<s:SolidColorStroke color="0x272E31" weight="1"/>
				</s:stroke>
			</s:Line>
		</s:Group>
		<s:RichText styleName="state" left="0" right="0" top="0" bottom="0" paddingTop="30">
			<s:textFlow>
				<s:TextFlow>
					<s:p textAlign="center">
						Er bevinden zich <s:span color="0xffffff">{startLength}</s:span> nummers op dit toestel.<s:br/>
						En <s:span color="0xffffff">{searchLength}</s:span> nummers in deze lijst.
					</s:p>
				</s:TextFlow>
			</s:textFlow>               
		</s:RichText>
	</s:Group>
</s:View>
